<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dynamic Match Patterns | LipSurf Plugin Developer Documentation</title>
    <meta name="description" content="Documentation for developers looking to extend LipSurf using the official API. Create extensions to control your browser via voice or create voice shortcuts for the browser.">
    
    
    <link rel="preload" href="/assets/css/styles.e4db8158.css" as="style"><link rel="preload" href="/assets/js/app.e4db8158.js" as="script"><link rel="preload" href="/assets/js/12.314a2a56.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.4dc000fb.css"><link rel="prefetch" href="/assets/js/1.4dc000fb.js"><link rel="prefetch" href="/assets/css/2.styles.75298dde.css"><link rel="prefetch" href="/assets/js/2.75298dde.js"><link rel="prefetch" href="/assets/js/3.8a824784.js"><link rel="prefetch" href="/assets/js/4.3968959a.js"><link rel="prefetch" href="/assets/js/5.49080c25.js"><link rel="prefetch" href="/assets/js/6.25302756.js"><link rel="prefetch" href="/assets/js/7.e3bc74fc.js"><link rel="prefetch" href="/assets/js/8.9ab44ea7.js"><link rel="prefetch" href="/assets/js/9.98390cc8.js"><link rel="prefetch" href="/assets/js/10.a0ebe030.js"><link rel="prefetch" href="/assets/js/11.2bdea4aa.js"><link rel="prefetch" href="/assets/js/13.16cf3472.js"><link rel="prefetch" href="/assets/js/14.e5065ff4.js"><link rel="prefetch" href="/assets/js/15.f8b85fdd.js"><link rel="prefetch" href="/assets/js/16.026176eb.js"><link rel="prefetch" href="/assets/js/17.42731cdc.js"><link rel="prefetch" href="/assets/js/18.9cf44579.js"><link rel="prefetch" href="/assets/css/19.styles.e659a062.css"><link rel="prefetch" href="/assets/js/vendors~docsearch.e659a062.js">
    <link rel="stylesheet" href="/assets/css/styles.e4db8158.css"><link rel="stylesheet" href="/assets/css/1.styles.4dc000fb.css"><link rel="stylesheet" href="/assets/css/2.styles.75298dde.css"><link rel="stylesheet" href="/assets/css/19.styles.e659a062.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon-128.png" alt="LipSurf Plugin Developer Documentation" class="logo"> <span class="site-name can-hide">LipSurf Plugin Developer Documentation</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/lipsurf/plugins" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/lipsurf/plugins" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Basics</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/" class="sidebar-link">Overview</a></li><li><a href="/quick-start.html" class="sidebar-link">5 Minute Quick Start</a></li><li><a href="/architecture.html" class="sidebar-link">Architecture</a></li><li><a href="/glossary.html" class="sidebar-link">Glossary</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Advanced</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/dynamic-matching.html" class="active sidebar-link">Dynamic Match Patterns</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dynamic-matching.html#wildcard-matching" class="sidebar-link">Wildcard Matching</a></li><li class="sidebar-sub-header"><a href="/dynamic-matching.html#numeral-matching" class="sidebar-link">Numeral Matching</a></li><li class="sidebar-sub-header"><a href="/dynamic-matching.html#match-function" class="sidebar-link">Match Function</a></li></ul></li><li><a href="/contexts.html" class="sidebar-link">Contexts</a></li><li><a href="/langs.html" class="sidebar-link">Internationalization</a></li><li><a href="/plugin-level-settings.html" class="sidebar-link">Plugin-level Settings</a></li><li><a href="/testing.html" class="sidebar-link">Unit Testing</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Support</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/help.html" class="sidebar-link">Get Help</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>API Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/api-reference/pluginbase.html" class="sidebar-link">PluginBase</a></li><li><a href="/api-reference/command.html" class="sidebar-link">Commands</a></li><li><a href="/api-reference/test.html" class="sidebar-link">Test</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Enterprise</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/api-reference/customstt.html" class="sidebar-link">Custom STT API</a></li><li><a href="/api-reference/script.html" class="sidebar-link">LipSurf.js</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="dynamic-match-patterns"><a href="#dynamic-match-patterns" aria-hidden="true" class="header-anchor">#</a> Dynamic Match Patterns</h1> <div class="warning custom-block"><p class="custom-block-title">NOTE</p> <p>It's recommended that you go through the <a href="/quick-start.html">5 Minute Quick Start</a> first to understand how to create and install your plugin.</p></div> <h2 id="wildcard-matching"><a href="#wildcard-matching" aria-hidden="true" class="header-anchor">#</a> Wildcard Matching</h2> <p>What if we want a plugin that accepts an arbitrary argument after some key words (AKA a slot)?</p> <p>Let's make a plugin that shows the weather for any city when user says: <span class="voice-cmd">weather for [city name]</span> (eg. <span class="voice-cmd">weather for Chiang Mai</span>)</p> <p><em>Easy peasy.</em></p> <p>Use <code>*</code> in your <code>match</code> string to greedily match any words.</p> <div class="language-ts extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-ts"><code><span class="token comment">/// &lt;reference types=&quot;lipsurf-types/extension&quot;/&gt;</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> PluginBase<span class="token punctuation">:</span> IPluginBase<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token operator">&lt;</span>IPluginBase <span class="token operator">&amp;</span> IPlugin<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span>PluginBase<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">{</span>
    niceName<span class="token punctuation">:</span> <span class="token string">'Weather'</span><span class="token punctuation">,</span>
    match<span class="token punctuation">:</span> <span class="token regex">/.*\.accuweather\.com/</span><span class="token punctuation">,</span>
    version<span class="token punctuation">:</span> <span class="token string">'1.0.0'</span><span class="token punctuation">,</span>
    commands<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'Check the Weather'</span><span class="token punctuation">,</span>
        description<span class="token punctuation">:</span> <span class="token string">'Check the weather for a given city.'</span><span class="token punctuation">,</span>
        <span class="token comment">// say it on any page (not just accuweather domain)</span>
        global<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        match<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'weather for *'</span><span class="token punctuation">,</span> <span class="token string">'forecast for *'</span><span class="token punctuation">,</span> <span class="token string">'weather in *'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        pageFn<span class="token punctuation">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>transcript<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> q<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// https://api.accuweather.com/locations/v1/cities/autocomplete?q=chiang%20mai&amp;apikey=d41dfd5e8a1748d0970cba6637647d96&amp;language=en-us&amp;get_param=value</span>
            <span class="token comment">// ex resp: [{&quot;Version&quot;:1,&quot;Key&quot;:&quot;317505&quot;,&quot;Type&quot;:&quot;City&quot;,&quot;Rank&quot;:41,&quot;LocalizedName&quot;:&quot;Chiang Mai&quot;,&quot;Country&quot;:{&quot;ID&quot;:&quot;TH&quot;,&quot;LocalizedName&quot;:&quot;Thailand&quot;},&quot;AdministrativeArea&quot;:{&quot;ID&quot;:&quot;50&quot;,&quot;LocalizedName&quot;:&quot;Chiang Mai&quot;}}]</span>
            <span class="token comment">// https://www.accuweather.com/en/th/chiang-mai/317505/weather-forecast/317505</span>
            <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`https://api.accuweather.com/locations/v1/cities/autocomplete?q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>q<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;apikey=d41dfd5e8a1748d0970cba6637647d96&amp;language=en-us&amp;get_param=value`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> cityId <span class="token operator">=</span> resp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Key<span class="token punctuation">;</span>
            <span class="token keyword">let</span> countryCode <span class="token operator">=</span> resp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Country<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> cityName <span class="token operator">=</span> resp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>LocalizedName<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token template-string"><span class="token string">`https://www.accuweather.com/en/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>countryCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cityName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cityId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/weather-forecast/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cityId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="numeral-matching"><a href="#numeral-matching" aria-hidden="true" class="header-anchor">#</a> Numeral Matching</h2> <p><em>Ain't nothin' to it.</em></p> <p>Use <code>#</code> in your <code>match</code> string to match numerals or ordinals including ones that are spelled-out (ie. <span class="voice-cmd">four-thousand</span>)</p> <p>Let's write a plugin that opens a tab with URL x for y minutes so that we can limit it's time wasting-ness. This might be useful if we need to check Facebook but don't want to get sucked into the feed for too long.</p> <div class="language-ts extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-ts"><code><span class="token comment">/// &lt;reference types=&quot;lipsurf-types/extension&quot;/&gt;</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> PluginBase<span class="token punctuation">:</span> IPluginBase<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token operator">&lt;</span>IPluginBase <span class="token operator">&amp;</span> IPlugin<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span>PluginBase<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">{</span>
    niceName<span class="token punctuation">:</span> <span class="token string">'Anti-procrastination'</span><span class="token punctuation">,</span>
    description<span class="token punctuation">:</span> <span class="token string">'Helpers for overcoming procrastination.'</span><span class="token punctuation">,</span>
    match<span class="token punctuation">:</span> <span class="token regex">/.*/</span><span class="token punctuation">,</span>
    commands<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'Self Destructing Tab'</span><span class="token punctuation">,</span>
        description<span class="token punctuation">:</span> <span class="token string">'Open a new tab with x website for y minutes. Useful for limiting the time-sucking power of sites like facebook, reddit, twitter etc.'</span><span class="token punctuation">,</span>
        global<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        match<span class="token punctuation">:</span> <span class="token string">'open * for # minutes'</span><span class="token punctuation">,</span>
        pageFn<span class="token punctuation">:</span> <span class="token punctuation">(</span>transcript<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> siteStr<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> minutes<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`site: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>siteStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, minutes: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>minutes<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="match-function"><a href="#match-function" aria-hidden="true" class="header-anchor">#</a> Match Function</h2> <p>For the most advanced cases, you can write a function that takes in transcripts as they come down the wire and return <code>undefined</code> when there's <em>no match</em>, or an array of arguments to pass to the <code>pageFn</code> when there <em>is</em> a match.</p> <p>Use cases include:</p> <ul><li>Match based on something on the page</li> <li>Match based on some internal plugin state</li> <li>Regex matching</li></ul> <p><em>Cake walk.</em></p> <p>We need to make <code>match</code> an object of type <a href="/api-reference/command.html#idynamicmatch"><code>IDynamicMatch</code></a></p> <p>How about a plugin for Gmail that moves the currently selected messages to a folder that the user commands to?</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>We could use the wildcard matching for this (eg. &quot;move to *&quot;) but then we cant limit the user's choices to valid folders.</p></div> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/// &lt;reference types=&quot;lipsurf-types/extension&quot;/&gt;</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> PluginBase<span class="token punctuation">:</span> IPluginBase<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token operator">&lt;</span>IPluginBase <span class="token operator">&amp;</span> IPlugin<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span>PluginBase<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">{</span>
    niceName<span class="token punctuation">:</span> <span class="token string">'Gmail'</span><span class="token punctuation">,</span>
    match<span class="token punctuation">:</span> <span class="token regex">/^https:\/\/mail\.google\.com/</span><span class="token punctuation">,</span>
    commands<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'Move to Folder'</span><span class="token punctuation">,</span>
        description<span class="token punctuation">:</span> <span class="token string">'Move already selected emails to a spoken folder'</span><span class="token punctuation">,</span>
        match<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            description<span class="token punctuation">:</span> <span class="token string">'Say &quot;move to [folder name]&quot;'</span><span class="token punctuation">,</span>
            fn<span class="token punctuation">:</span> <span class="token punctuation">(</span>transcript<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// exercise left to the reader...</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        pageFn<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// exercise left to the reader...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">NOTE</p> <p>The match function needs to check the whole transcript for matches and then return indexes for which parts it used.
This way the transcript can have the proper section success highlighted (in green) that matches a command, and command chaining will work.</p></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/lipsurf/plugins/edit/master/docs/dynamic-matching.md" target="_blank" rel="noopener noreferrer">Improve this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last updated: </span> <span class="time">11/7/2019, 3:57:56 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/glossary.html" class="prev">
          Glossary
        </a></span> <span class="next"><a href="/contexts.html">
          Contexts
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/12.314a2a56.js" defer></script><script src="/assets/js/app.e4db8158.js" defer></script>
  </body>
</html>
